---
title: CLI Reference
description: Complete command-line interface reference
---

# CLI Reference

Complete reference for all Keystone CLI commands.

## Global Options

```bash
keystone [OPTIONS] <COMMAND>
```

**Options:**
- `--dry-run`: Preview changes without applying them
- `-h, --help`: Print help information
- `-V, --version`: Print version information

## Commands

### rotate

Rotate a secret in dev or production.

```bash
keystone rotate [SECRET_NAME] [OPTIONS]
```

**Arguments:**
- `SECRET_NAME`: Name of the secret to rotate (optional if using `--from-signal`)

**Options:**
- `--env <ENV>`: Environment (dev/staging/prod) [required]
- `--service <SERVICE>`: Service name (vercel/netlify/render/cloudflare/fly/aws/gcp/azure)
- `--from-signal`: Trigger rotation from app signal
- `--redeploy`: Trigger redeploy after rotation (prod only)
- `--value <VALUE>`: Custom secret value (auto-generated if not provided)
- `--env-file <PATH>`: Path to .env file (dev mode only)

**Examples:**

```bash
# Dev mode
keystone rotate MY_API_KEY --env dev

# Production with Vercel
keystone rotate MY_API_KEY --env prod --service vercel

# With custom value
keystone rotate MY_API_KEY --env prod --service vercel --value "my-secret-123"

# Dry run
keystone rotate MY_API_KEY --env prod --service vercel --dry-run

# With redeploy
keystone rotate MY_API_KEY --env prod --service vercel --redeploy
```

### rollback

Rollback a secret to its previous value.

```bash
keystone rollback <SECRET_NAME> [OPTIONS]
```

**Arguments:**
- `SECRET_NAME`: Name of the secret to rollback [required]

**Options:**
- `--env <ENV>`: Environment (dev/staging/prod) [required]
- `--service <SERVICE>`: Service name (for prod mode)
- `--redeploy`: Trigger redeploy after rollback (prod only)

**Examples:**

```bash
# Dev mode
keystone rollback MY_API_KEY --env dev

# Production
keystone rollback MY_API_KEY --env prod --service vercel

# With redeploy
keystone rollback MY_API_KEY --env prod --service vercel --redeploy
```

### daemon

Manage the background daemon for app-signal rotation.

```bash
keystone daemon <ACTION>
```

**Actions:**
- `start [--bind <ADDRESS>]`: Start the daemon
- `stop`: Stop the daemon
- `status`: Check daemon status

**Options:**
- `--bind <ADDRESS>`: Bind address (default: 127.0.0.1:9123)

**Examples:**

```bash
# Start daemon
keystone daemon start

# Start on custom port
keystone daemon start --bind 0.0.0.0:9123

# Stop daemon
keystone daemon stop

# Check status
keystone daemon status
```

### audit

View audit logs for secret rotations.

```bash
keystone audit [SECRET_NAME] [OPTIONS]
```

**Arguments:**
- `SECRET_NAME`: Filter by secret name (optional)

**Options:**
- `--env <ENV>`: Filter by environment
- `--last <N>`: Show last N entries

**Examples:**

```bash
# All recent rotations
keystone audit --last 10

# Specific secret
keystone audit MY_API_KEY

# Specific secret and environment
keystone audit MY_API_KEY --env prod

# Last 5 entries for an environment
keystone audit --env prod --last 5
```

### config

Manage Keystone configuration.

```bash
keystone config [ACTION]
```

**Actions:**
- `show`: Display current configuration (default)
- `init`: Initialize default configuration

**Examples:**

```bash
# Show config
keystone config
keystone config show

# Initialize config
keystone config init
```

## Exit Codes

- `0`: Success
- `1`: General error (invalid arguments, operation failed, etc.)
- `101`: Compilation/build error (internal use)

## Environment Variables

### Core Settings

- `KEYSTONE_CONFIG_PATH`: Path to config file
- `KEYSTONE_AUDIT_LOG_PATH`: Audit log directory
- `KEYSTONE_COOLDOWN_SECONDS`: Cooldown period
- `KEYSTONE_ROLLBACK_WINDOW_SECONDS`: Rollback window
- `KEYSTONE_DAEMON_BIND`: Daemon bind address

### Provider Credentials

**Vercel:**
- `VERCEL_TOKEN`
- `VERCEL_PROJECT_ID`

**Netlify:**
- `NETLIFY_AUTH_TOKEN`
- `NETLIFY_SITE_ID`

**Render:**
- `RENDER_API_KEY`
- `RENDER_SERVICE_ID`

**Cloudflare:**
- `CLOUDFLARE_API_TOKEN`
- `CLOUDFLARE_ACCOUNT_ID`
- `CLOUDFLARE_WORKER_NAME`

**Fly.io:**
- `FLY_API_TOKEN`
- `FLY_APP_NAME`

**AWS:**
- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION`

**GCP:**
- `GOOGLE_APPLICATION_CREDENTIALS`
- `GCP_PROJECT_ID`

**Azure:**
- `AZURE_CLIENT_ID`
- `AZURE_CLIENT_SECRET`
- `AZURE_TENANT_ID`
- `AZURE_VAULT_NAME`

## Configuration File

Default location: `~/.keystone/config.toml`

See [Configuration](/docs/configuration) for full details.

## Shell Completion

Generate shell completion scripts:

```bash
# Bash
keystone completions bash > /etc/bash_completion.d/keystone

# Zsh
keystone completions zsh > /usr/local/share/zsh/site-functions/_keystone

# Fish
keystone completions fish > ~/.config/fish/completions/keystone.fish
```

*Note: Completion generation not yet implemented*

