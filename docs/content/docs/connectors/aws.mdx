---
title: AWS Secrets Manager Connector
description: Rotate secrets in AWS Secrets Manager
---

Birch integrates with AWS Secrets Manager to update and retrieve secrets in your AWS account.

## Prerequisites

- AWS account with Secrets Manager access
- IAM credentials with appropriate permissions

## Required IAM Permissions

Your IAM user or role needs the following permissions:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "secretsmanager:CreateSecret",
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue",
        "secretsmanager:PutSecretValue"
      ],
      "Resource": "*"
    }
  ]
}
```

## Setup

Configure AWS credentials via environment variables:

```bash
export AWS_ACCESS_KEY_ID="your-access-key"
export AWS_SECRET_ACCESS_KEY="your-secret-key"
export AWS_REGION="us-east-1"
```

Or use the configuration file:

```toml
[connector_auth]
aws_access_key_id = "your-access-key"
aws_secret_access_key = "your-secret-key"
aws_region = "us-east-1"
```

## Usage

Rotate a secret in AWS Secrets Manager:

```bash
birch rotate MY_SECRET_NAME --env prod --service aws
```

The connector will:
1. Check if the secret exists in Secrets Manager
2. If it exists, update the secret value
3. If it does not exist, create a new secret with the provided value

## Application Restart

AWS Secrets Manager updates the secret value but does not automatically restart your applications. After rotation, you must manually restart services that use the rotated secret:

```bash
# Example: Restart ECS service
aws ecs update-service --cluster my-cluster --service my-service --force-new-deployment

# Example: Update Lambda function
aws lambda update-function-configuration --function-name my-function --environment Variables={MY_SECRET_NAME=new-value}
```

## Rollback

Rollback to the previous secret value:

```bash
birch rollback MY_SECRET_NAME --env prod --service aws
```

## Notes

- Secrets are versioned automatically by AWS Secrets Manager
- The connector creates secrets if they do not exist
- Automatic application restarts are not supported
- Use hosting provider connectors (Vercel, Netlify, etc.) for automatic redeployment

